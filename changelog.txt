This is K-Mod version 1.17.
If you have any questions, comments, suggestions, bug reports, etc. Post here: http://forums.civfanatics.com/showthread.php?p=10094243

--
v1.17 changelist

+ Fixed an original BtS problem which prevented units from being un-grouped before they were automated.
+ Fixed a couple of problems with the way BUG detects the BtS user documents directory. (The original system was unable to expand environment variables in the path name.)
+ Changed the message sound effect for reporting the death of a warlord. (Previously it was the era defeat sound; now it is the "intercepted" sound. It still isn't a great fit, but it's better.)
+ The AI for automated units now executes during the "automoves" part of the turn rather than at the start of the turn. (Also, reverted the change which delayed the execution of automated unit missions. Automated units will act at the end of the turn, as they did in the previous version of K-Mod, but they will make their decisions using the latest information.)

AI

+ Completely replaced the AI for deciding when cities should slave-whip and rush-buy. The new system will whip more often, but hopefully only when it is wise to do so. The calculation to decide when to slave-whip has some dependence on the personality of the AI player - some AIs will prefer to grow their cities; some will be especially keen to get lots of overflow hammer from whipping. The new AI is better able to adapt to different game rules. In particular, the new AI can handle hurry commands which combine gold cost and population cost; such a combination would cause the old AI to get confused and make mistakes.
+ The city governor is now allowed to slave-whip in cities set to auto production - but the governor uses slightly stricter rules than the AI players use.
+ Fixed a bug in AI_retreatToCity which caused pass 1 and 2 to be the same rather than using "ignore danger" on pass 2. (This bug was my fault.)
+ Fixed a bug in CvPlayerAI::AI_disbandValue which blocked units from being disbanded when in a well guarded city instead of blocking when in a poorly guarded city.
+ Made some other value adjustments to AI_disbandValue.
+ Fixed a bug in AI_tradeMissionValue which sometimes caused AI merchants to oscillate between trying to join a city and an impossible trade mission.
+ Slightly improved the behaviour of recon spies.
+ Closed a few problematic conditions the AI used to build units when in financial trouble. (units which would then be deleted a few turns later...)
+ AI_buildingValue now ignores half of the happiness points from military units - this is to prevent cities from getting messed up when an army decides to leave, or when the player changes civics.
+ Further lowered the AI's value of gold from specialists and buildings when it is earning more than it is spending.
+ Added some missing components to the AI's evaluation of random event options.


--
v1.16 changelist

+ Amphibious landings can now be executed even if the group isn't ready to move. (eg. if you have a transport on the coast, with no moves left, ordering it to move onto the land will now cause it to unload its cargo.)
+ Automated units will wait until the "automoves" phase before moving, rather than doing it as soon as it is their turn. (This will require some testing to make sure I haven't messed something up.)
+ Fixed a problem which sometimes caused automated units to repeated cancel and reorder their commands.
+ Made some changes to the 'resolutions' tab on the victory screen (F8). Each vote source now has a heading, and displays the number of turns until the next vote and number of votes until the next election. (I've also made a couple of minor changes to other parts of the victory screen.)
+ Rewrote the code that handles the highlighting of goody-huts and city site recommendations. It should now be more efficient for non-settlers and non-scouts, and it will now show all city sites within 7 turn range, rather than 4 plot range.
+ Units that fail to move with their group should now stay in a single split-off group rather than being completely separated.
+ Made some minor efficiency improvements.

AI

+ Completely redesigned the system for handling stranded units. The new system is less likely to cause OOS errors, it is faster, and it fixes several bugs in the old system. For example, with the previous system (from BBAI) stranded units would often fail to recognise that they are being rescued, and thus would not load into the boat.
+ Tightened the requirements for the AI to consider starting a second war.
+ Corrected a couple of minor problems related to the AI's early-game defence of cities.
+ Made some adjustments to the AI's war-time espionage point targets.
+ CvSelectionGroup::startMission will now allow attack orders with MOVE_DIRECT_ATTACK to be executed even when not all units in the group can move. (This should enable "follow" attacks, which previous would just not happen.)
+ Tweaked AI_exploreMove to let them pillage bonuses a bit more readily.
+ Tweaked AI_buildGovernorChooseProduction to be a bit less likely to choose the culture production and to be less likely to build spies.

--
v1.15 changelist

+ Teams are now allowed to capitulate even when it would result in a violation of their peace treaties. (This is similar to how defensive pacts can cause teams to violate peace treaties. Note: this change does not apply to voluntary vassals.)
+ "No culture flipping after conquest" now prevents cities from flipping back to the /team/ of the previous owner, rather than just the previous owner themself.
+ Units bumped out of closed borders will now stay in their groups when possible. (This will help the AI to recover when it botches its invasion approach path. The AI can still screw up, but this change will make it less bad.)
+ The field-of-view BUG setting will now still apply after the adjustment slider is turned off. (So you can activate the slider, set it how you like it, and then hide the slider without losing your settings.)
+ Made a minor adjustment to how Rapid Unit Cycling works after automated moves.
+ Made several minor efficiency improvements.

AI

+ Rewrote the AI's decision making process for disbanding units when in financial trouble; hopefully it will now be a bit faster and a bit smarter.
+ Made several improvements to the way the AI chooses target cities - it will now have slightly better coordination between stacks, and it will adjust its targets based on the type of war plan it is using.
+ Fixed a bug which caused the AI to sometimes forget that it could avoid a river when attacking a city.
+ Fixed a bug which sometimes prevented AI stacks from attacking cities guarded only by wounded defenders.
+ Made several changes to the AI's city attack behaviour (grouping, pillaging, attack threshold, etc)
+ Increased the AI's estimate of collateral damage when calculating attack strength.
+ Rewrote most of AI_choke, to correct several behavioural problems.
+ Adjusted the behaviour of UNITAI_COLLATERAL to be more willing to attack invading forces.
+ Fixed a problem in AI_guardCityMinDefender which sometimes caused the AI to reinforce defended cites while neglecting completely undefended cities.
+ Reserve units will no longer leave a city completely undefended.

--
v1.14 changelist

+ Polished up the old BUG Military Advisor screen to better match the style of the other advisor screens, and re-enabled it in the BUG options.
+ Move commands are now automatically canceled when the move reveals an obstacle which will increase the moves required to reach the destination.
+ K-Mod will now automatically create its settings folder inside the user folder 'Documents\My Games\Beyond the Sword'. This allows settings to be saved even when Civ4 is installed in program files and run without admin rights.

AI

+ Added some new defensive behaviour for the AI's city attack units and counter units.
+ The AI will now consider the possibility of using sea transports when choosing target cities on the local continent. (This should help on wiggly maps.)
+ Made some adjustments to AI_techBuildingValue, primarily to stop the AI from falling over themselves to get access to wonders for cultural victories.
+ Fixed a K-Mod bug which was weakening the XP discount of charismatic leaders.
+ Improved the efficiency of AI_assaultSeaReinforce by using a separate pathfinder when looking for a synchronised landing.

--
v1.13 changelist

Game mechanics

+ The Sistine Chapel's bonus culture on religious buildings is no longer doubled for 1000 year old buildings. (For example, previous a 1000 year old temple with the Sistine Chapel would give (1+3)*2 = 8 culture. Now it will only give 1*2+3 = 5 culture.)
+ Rewrote the formula for the natural spread of religion. (It now depends on two new xml values: RELIGION_SPREAD_DIVISOR_BASE and RELIGION_SPREAD_DISTANCE_FACTOR. Cities with well established culture and large population have a better chance of getting 2nd / 3rd religions spread to them.)

AI

+ Corrected some problems with the strategy-rand initialization.
+ Tightened the rules for converting units for crush to reduce the chance of leaving a city undefended.
+ Fixed three bugs from the original BtS code which could sometimes cause the AI's amphibious group-attacks to be canceled prematurely.
+ Fixed a bbai bug which sometimes caused the AI to order amphibious attacks when it doesn't mean to.
+ Added a check in AI_localAttackStrength to not count amphibious siege attacks when bCheckCanAttack is set.
+ Tweaked the condition for canceling join missions when launching an assault group.
+ Reduced the overly-optimistic estimates for the number of bonuses available when evaluating corporations.
+ Fixed a factor of 100 mistake in the base-maintenance component of AI_corporationValue.
+ Increased the maintenance estimate for corporation value.
+ Fixed a bug which reversed the priority of units when deciding who should pillage first. (this affects human players as well)
+ Added and integrated new code hurrying wonders with great engineers. The new system will be more likely to hurry powerful wonders, and less likely to waste engineers on wonders that are almost finished.
+ AI_greatPersonMove now uses path turns as a tie-breaker for "slow" missions with equal value. (ie. build, join, and hurry.)
+ Fixed a factor of 10 mistake in the evaluation of great person points for permanent specialists.
+ Changed the way AI_pickTargetCity accounts for city defences. (This fixes a problem which caused groups with no bombard to almost always target cities with no defences.)
+ Changed the way commerce multipliers are evaluated in AI_buildingValue. (Previously they were worth 6.6 points per commerce. They are now worth 5 points per commerce, but the commerce is an inflated estimate.)
+ Diluted the effect of GPP multipliers, to prevent the AI from using specialists when it should be trying to grow.
+ Increased the devaluation rate of GPP wrt the number of great people created.
+ Reduced the value of espionage for teams that haven't met anyone.

--
v1.12 changelist

+ Ballista elephants now get 1 first strike.
+ Increased the natural spread of religion, especially in very large cities and in cities with no (or few) religions. (This still needs some testing. It may be too strong.)

+ Cargo units will now stay grouped when their transports move, unless the transports themselves are separated.
+ Made several efficiency improvements. Most notably, CvPlayerAI::AI_unitUpdate will now make a second pass over all the groups if the number of groups changes - this sometimes saves us from having to wait for the next timeslice when a group is split.

+ Rewrote the way the AI hunts down stray units in its territory. (Replaced AI_Protect with a new function called AI_defendTerritory.)
+ Added new function, CvPlayerAI::AI_deduceCitySite. The purpose of this function is to decide if it is reasonable for the AI to know of the existence & location of a particular city based on how much of the cultural borders have been seen.
+ Added some functionality to AI_leaveAttack: the minimum defence threshold will now be ignored if the AI thinks offence will be the best defence.
+ Fixed a mistake in the original code for AI_guardBonus, which caused the AI to undervalue resources.
+ Fixed a bug in AI_cityAttack which caused the function to ignore the odds threshold.
+ Fixed a bug in AI_defensiveCollateral which basically disabled the value bonus which is meant to come when the invading stack is defeatable.
+ Changed the way AI_settleMove responds to danger - it will now compare the enemy's strength to the group's strength.
+ The AI will now ungroup units when it upgrades them, so that when the upgraded unit loses all its moves it doesn't prevent the whole group from moving.
+ Reduced the threshold that the AI's attackCity stacks use to decide if they should wait for units to be upgraded.
+ Made several changes to the behaviour of the AI's attack units.
+ The AI will now group all its cargo units before ordering an amphibious attack landing. (This prevents them from using the next turn just to reorganise their group.)
+ Fixed some minor mistakes in the BBAI navel assault code.
+ The AI's navy is now more likely to defend its sea resources.
+ The AI is now slightly more likely to spies for recon.
+ Reduced the AI value of XP buildings in low productivity cities.
+ Reduced some of the modifiers in AI_getWeightedOdds.
+ AI_localDefenceStrength and AI_localAttackStrength now take first strikes into account (with a very rough approximation).
+ Fixed a bug in AI_localDefenceStrength which could sometimes cause the AI's tactical memory to be set incorrectly.

+ Implemented a new AI system for evaluating different types of great people points. Disabled the old (basic) system. (This will help the AI to get corporations, as well as holy buildings, and so on.)
+ Added a new section in AI_techValue for corporations. (Previously, corporation value would only be counted if the tech founded the corporation directly. With the new code, the corporation will be evaluated if the tech enables the HQ building.)
+ CvCityAI::AI_permanentSpecialistValue now uses CvCityAI::AI_getYieldMultipliers to adjust yield values. (This still needs some testing.)
+ CvCityAI::AI_getYieldMultipliers (which tells the AI how much to value each kind of yield) now includes yields from buildings and specialists in its tally for total food and total production. (It now uses a different counting method. Hopefully it works correctly...)
+ Adjusted the way espionage is valued, so that it doesn't get overvalued when only a few civilizations are known.
+ Increased the AI's value for culture, especially when considering a cultural victory. (This may need further tweaking.)
+ Fixed a bug in the way corporation HQ buildings are evaluated. (Specifically, the value of the new corp and old competing corps were being compared with different scales.)
+ Made some changes to corporation evaluation, both for accuracy and efficiency.

+ Added donation information to readme.txt.

v1.12b

+ Fixed a rare bug which could cause the game to hang when the AI used MOVE_ATTACK_STACK with MISSION_MOVE_TO_UNIT.

--
v1.11 changelist

Game mechanics

+ The cost of the switch religion espionage mission is now increased when trying to switch to a religion that is spread to fewer cities than the current religion.

AI

+ Fixed a bug which caused the AI (and automated cities) to sometimes rush-buy buildings under the wrong circumstances.
+ Adjusted the way the AI evaluates city danger levels. It should now defend its borders slightly more strongly.
+ Slightly increased the AI's max unit spending for alert and total war.
+ Fixed an inconsistency in pathDestValid which under rare circumstances could cause the AI to lock up.
+ Reduced the AI's vision cheating in AI_pillageValue.

+ Rearranged and adjusted some parts of the attack-city AI to fix a few problems which would sometimes cause the AI's stacks to oscillate between moving to attack and moving to pillage.
+ Fixed an original BtS bug in AI_pillageValue. (it was under-valuing bonuses)
+ Made several changes to the pillaging AI.
+ Rewrote parts of CvUnitAI::AI_choke, to be smarter and more efficient.
+ Changed the way the AI evaluates ordinary attacks. (This is a significant change. There may be undiscovered negative side effects.)
+ Fixed a problem from the original BtS code which caused the game to sometimes think workboats should try to put roads on sea resource.
+ The value penalty for techs that obsolete buildings is now slightly higher, but reduced for science_flavor civs.
+ The AI's value for great people points from specialists now decreases based on how many great people their civ has created so far.
+ Rewrote sections of AI_techUnitValue. (The new code should give a more sensible value boost for different strategies; alert, turtle, conquest, etc.)
+ For unit tech value, prereqs which cannot yet be researched now count as 2 missing prereqs rather than just one.
+ Slightly increased the production emphasis for flavor_production.
+ Adjusted the conditions the AI uses to decide if its attack stack should wait for reinforcements before moving out. (They are now less likely to wait if the target city is close.)
+ The AI will no longer automatically cancel deals with their worst enemy if their worst enemy happens to be their master. (They will always be willing to trade with their master, so it makes to sense to cancel the deals.)


UI

+ Fixed an original BtS problem which made it hard for the player to deselect a unit after all of their units had moved.
+ Fixed an original BtS bug which caused minimized popups to steal the focus if the player tried to queue multiple moves with their final unit.
+ Fixed a bug in the economics adviser screen which caused the +/- buttons for the research slider to open the environmental tab.
+ Improved the symmetry breaker in the pathfinder. (The symmetry breaker is a K-Mod feature which is meant to prevent the game from showing the wrong path to the player when issuing a move command.)
+ Disabled a couple of checks which prevented the player from selecting units which have recently moved in simultaneous turns mode. (I'm pretty sure the remaining stuff is still enough to 100% enforce the MIN_TIMER_UNIT_DOUBLE_MOVES rule; the checks that I removed were unnecessary and annoying. Please tell me if I'm wrong. ie. tell me if you are able to bypass the minimum double-moves time in simultaneous turns mode.)
+ For human players, "border danger" is no longer counted on plots that are defended. (This means that combat units ordered to move through enemy lands will not be interrupted unless they see an actual enemy; and that workers will not be interrupted just for working on the border if they are defended.)
+ The screen will now center on newly drafted units rather than just selecting them.
+ Increased the effect of the emphasis buttons in the city screen.

Back-end

+ Added new xml value: BBAI_MINIMUM_FOUND_VALUE. (The purpose of this is to allow the AI to be adjusted to work more sensibly in other mods based on K-Mod.)
+ When forming a permanent alliance, deals are now canceled /after/ the team numbers have been reassigned. This should prevent the new allies from being bumped out each other's territory when their open borders deals are automatically canceled.
+ The attitude cache from the CAR mod (included in BBAI) is now saved in the savefiles - this is to avoid potential OOS problems when a player joins mid-game.
+ Removed a potential OOS problem caused by the new tactical AI memory.
+ Fixed a pathfinding efficiency problem in CvPlayerAI::AI_isPlotThreatened. (It wasn't using the advantages of the new pathfinder.)


--
v1.10 changelist

+ Wrote a new pathfinding engine. The new system produces the same results as the original system, but it is slightly more flexible and can be used much more efficiently. With the new pathfinding engine, and related changes, the game now runs significantly faster. (Note: for efficiency reasons, the new pathfinder currently assumes that there can be no roads on the ocean. If this is used in a mod that does have ocean roads, the pathfinder may produce non-optimal results.)
+ Changed the structure of the pathValid function, and the groupPathTo to help prevent future bugs. (This completely removes the possibility of the AI entering forbidden territory - which was the target of a few previous bug fixes.)
+ Fixed a rare bug which could potentially cause the auto-production governor to crash the game.

+ Added new AI function, AI_stackVsStack, which is used in AI_attackCityMove - this allows the AI to use its attack stacks to wipe out enemy attack stacks.
+ Taught the AI to conscript more freely when it is good value. (With standard settings, this will only happen for riflemen.)
+ Fixed a problem in AI_promotionValue which was preventing the AI from choosing healing promotions as often as intended.
+ Rewrote CvUnitAI::AI_guardCity. The rewrite fixes a double-counting problem which caused units to oscillate in and out of cities; removes some duplicated code; and gives higher priority to cities which need more defenders.
+ Adjusted AI_groupFirstVal values so that ATTACK_CITY always scores higher than ATTACK. (Previously, the overlap sometimes caused the AI to become confused about how it should group its units.)
+ Tweaked recon spy plot value so that it favours enemy territory.
+ Tweaked the conditions for the AI SPACE3 strategy.
+ Added the possibility of the AI converting their UNITAI_EXPLORE units to UNITAI_ATTACK, rather than just deleting them.
+ If the AI has not seen any target cities, it will magically know the location of the closest city in the area. This is so that they city attack stacks don't stay idle when no cities have been seen. (Think of it like a human player inferring the position based on the shape of the border. - Note: in the original AI the AI cheated like this for all cities - not just the closest city, and not just in the local area.)

v1.10b
+ Fixed a problem from the original BtS code which caused the AI to delete units more often than it should. For example, it would delete all the defenders in a city, and it would delete units immediately after drafting them.
+ Fixed a late-game bug which could potentially cause a crash.
+ Added a special symmetry breaking compontent to the pathfinder. Hopefully this will prevent some problems which result from having two paths with equal cost. (eg. The interface showing one path, and then the units following a different path.)
+ Fixed a pathfinding problem which might have been able to cause OOS errors. (It's hard to say for sure if it was actually a problem or not.)
+ Fixed a problem which sometimes caused the AI to cancel deals with their master.

--
v1.09 changelist

+ Fixed a critical bug which caused the game to behave unpredictably if any new civ teams are created mid-game (eg, liberated colony) - eg. the game may create extremely large save files. (This was a serious bug; and I'm sorry I didn't find it sooner.)
+ Fixed a BBAI bug which sometimes caused the game to hang when using sea-patrol.
+ Fixed a bug which allowed negative plot yield values to be evaluated by the AI. (This bug didn't affect K-Mod itself, but it could cause a crash in other mods using the K-Mod dll.)
+ Fixed another instance of the bug which allowed the AI can enter forbidden territory immediately before declaring war.
+ Fixed a problem which was causing random numbers based on AI_getStrategyRand to give answers outside of the expected range. (Fixing this problem will cause the AI to behave differently to before. It may require some more adjustments to rebalance it.)
+ Fixed a mistake in AI_attackCityMove which caused the AI to incorrectly estimate the penalty from crossing rivers.

+ Paradops can now be performed with multiple units simultaneously instead of just one unit at a time.
+ Players are no longer allowed to air-bomb improvements or cities that they don't know exist. (ie. the improvement has to appear on the map to be a valid target - but direct visibility is not required.)

+ Added the stack promotions option from the latest version of the BUG mod.
+ Enabled the power ratio scoreboard option from BUG.
+ The number of cities scoreboard option from BUG will now only show the number of cities that are currently revealed on your map. (ie. it does not count any cities that you haven't seen.)
+ Added new and improved Italian game-text translations, provided by Axios.
+ Added some more language localization to the economics adviser screen (but it still isn't finished).
+ City info on the main screen will now be updated after espionage missions. (So that, for example, production is shown to be zero after a successful sabotage production mission.)

+ Increased the target city productivity for the AI; especially for AIs whose personality favors productivity.
+ Added some flavour adjustments for the AI's evaluation of forest chopping.
+ Tweaked various AI flavour based effects.
+ The AI's choice of target city is now adjusted based on its memory of the city's garrison. (using the AI's new tactical memory.)
+ Made various changes to the naval assault AI.
+ Made various changes to the way the AI groups it units.
+ Reworked the effect of AI_STRATEGY_PRODUCTION. It is now only triggered in rare circumstance, and it has a greater effect on the AIs strategy.
+ Corporation yield is now taken into account when choosing plot improvements.
+ Tweaked some of the worker AI.
+ Reduced the probability of the AI building spies in low productivity cities.
+ The AI will now reconsider its current city production after a building is sabotaged.

v1.09b
+ Fixed an AI deadlock bug.

--

v1.08 changelist

+ Gunships now start with the Amphibious promotion.

+ Units will no longer automatically attack if they are ordered to move into an unseen enemy unit in the fog of war.
+ Fixed a rare divide-by-zero crash.
+ Added a workaround for a rare bug which sometimes allows the AI to use enemy roads just before declaring war. (The root cause of the bug has not been fixed, but I don't think there are any more cases where it can actually happen.)

+ Added some basic AI memory so that it can remember to walk around well defended choke-points without having to cheat.
+ Fixed several problems in the sea assault AI, including a somewhat tragic original BtS bug which caused the AI to think 4 units was enough for an invasion force. (The AI may struggle to get enough units for a navel invasion now - but hopefully this will be much better in the long run.)
+ Made some adjustments to the settler AI. - Mostly to fix a problem which sometimes caused them to not settle in the best places first.
+ Fixed a K-Mod bug which caused some AIs to expand very slowly at the start of the game.
+ Fixed some silly mistakes in the AI's strength comparison calculation in AI_attackCityMove.
+ Tweaked the effect of the expansive flavour flag in the AI's city placement.
+ Increased the AI's warplan abandon time for overseas wars. (so that it is less likely to give up on its warplan if it isn't quite ready to attack.)
+ Adjusted the effect of city defensive in how the AI chooses which cities to attack.

--

v1.07b changelist

+ Victory votes now require a minimum number of "full members" rather than just "voting members". This means that the Apostolic Palace victory vote is only valid if there are at least 3 full members.

+ Fixed a problem which caused the AI to place its early cities closer together than intended.
+ Civs with the "ambitious" personality trait are now less conserned about the geographical shape of their empire when founding cities.
+ Tweaked the settler unit AI so that it is less discourged by distance when choosing which site to go to.
+ Made several changes to the way the AI chooses target cities to attack. In particular, it will now prefer to attack cities that are close to the area target; it will prefer to attack cities that aren't on hills; and (hopefully) it will be a bit less predictable, but still smart in its city selection.
+ Removed an unintended factor of 3 in the population component of the floating defender formula.

--

v1.07 changelist

+ Increased the cost of steal treasury espionage missions.

+ Fixed a bug which caused Civ4 to crash if the player started a game, exited back to the main menu, and then started a new game with Rapid Unit Cycling enabled.
+ The average game era no longer counts the barbarian's era. (This affects culture pressure, AI unit build probabilities, UI sound effects, and a few other things. Hopefully it isn't a big deal.)
+ Fixed some minor problems with how attack penalties are counted in the pathfinding cost function.
+ Put a city-info dirty flag into setCommercePercent. Hopefully this will fix a bug which sometimes causes city happiness to not update on the main screen.

+ Some AI personalities will now choose their city sites slightly further apart.
+ Made some adjustments to the AI's gold target. It should now scale a bit better on different game speeds; and it now affected by the AI's personality.
+ The AI will no longer create huge amounts of useless gold when doing AI_avoidScience.
+ The AI will now try to spend their excess money slightly faster.

+ The AI is now capable of arranging tech trades that involve multiple techs - both AI-to-AI, and AI-to-human.
+ Tech trade deals offered to human players can now sometimes include a small discount. (ie. If you try to renegotiate a deal, you might not get as good a deal as was originally offered - so it might now be worth considering the deal the AI offers you rather than going straight to the renegotiate button!)
+ The AI's willingness to accept uneven trades now depends on their attitude towards the trade partner, and their relative ranks. eg. The AI will allow itself to offer slightly larger discounts to its friends, and to civs who are low on the scoreboard. (Note. this doesn't affect trades that the human proposes to the AI. It only affects deals that the AI proposes.)

+ Adjusted the way the AI calculates threat to its cities.
+ City attack groups will sometimes retreat if they are too weak to threaten their target city.
+ The AI will now be less willing to walk massive distances to attack barbarian cities.
+ The AI will now be willing to defend high-value bonuses with put multiple units rather than just one. (This still needs some work.)
+ Adjusted the way the AI chooses which city to attack.
+ Taught the AI some new techniques for using collateral damage defensively.
+ Rewrote most of the AI's plot strength evaluation routines so that they are more consistent with one another. The main effects of this is that the AI will now consider collateral attack power in some places where it didn't use it; and it will not count the strength of units that it cannot see in some places where it use to (ie. it will now cheat slightly less than in the original BtS code).
+ Some AI personalities will now use slightly larger attack stacks.
+ Increased the number of floating defenders the AI thinks are required for the later era.

+ Fixed a bug which sometimes caused the AI's to just attack with one unit rather than the entire group.
+ Fixed an original BtS bug which often caused units to forget their mission AI type. (This caused general confusion in the AI - I suspect this was the real root cause of the settler bug I fixed several versions ago.)
+ Disabled the original BtS "groupDeclareWar" checks. The AI now must choose to declare war before moving their units - just like a human player does. (This will stop the AI from accidentally declaring war when it happens to move an explorer towards potential enemy territory!)

--

v1.06 changelist

+ Fixed some problems with AI unit training probability being too small (caused by side effects of some of my other changes)
+ Fixed several problems with the new corporation spread AI.
+ Fixed an original BtS bug which essentially always caused the AI's gold target to be divided by 3.
+ Rewrote some of the AI's gold budgeting functions to compensate for the gold target bugfix and to improve their gold usage.
+ Removed double-counting of the yield value of plot features when calculating improvement value, and rebalanced some other values to compensate for the change.
+ Fixed a problem with AI_calculateAreaAIType which caused the AI to overestimate enemy power while preparing for war. (This caused the AI to abandon war-plans more often than it should.)
+ Made some adjustments to the AI's reasoning for splitting their empire.
+ Tightened the AI's rules for when to disband workers.
+ Tightened the conditions for when the AI will choose to build a new worker. (these two changes are meant to fix a problem which sometimes caused the AI to constantly build and disband workers.)
+ Fixed an original BtS bug in evaluation of workers in AI_disbandUnit. (This is not currently being used anyway.)
+ The AI will now accept gifted great people even while in financial trouble. (not that anyone is likely to want to give away great people anyway...)
+ Fixed a bug in the original code which could (very rarely) cause AI units to get stuck trying to attack an enemy that is inside the borders of some third civ.
+ Fixed an int overflow bug in the original BtS code for AI_specialistValue.
+ Made some changes to AI diplomacy. The game will now check that _both players_ are willing to talk to one another before they set up a trade. (Previously the check was one-sided.)
+ Made structural changes to some parts of the AI. (Some changes for efficiency; some to lay the foundations for future changes - I'm just mentioning this because there might be new bugs...)

+ Fixed a problem with the new auto citizen assignment - a rare case which could cause cities to unnecessarily starve while building settlers.
+ Fixed a rare bug which sometimes allowed the automatic citizen assignment to assign a free specialist to a plot. (Triggered when the value of the plot was exactly equal to the value of the specialist.)
+ Fixed a rare crash bug. (Triggered when an AI spy arrives at a targeted bonus improvement on the same turn that the plot loses all player ownership.)

+ Added a new BUG option: Rapid Unit Cycling. This option removes the delay between issuing a command to a unit and the automatic selection of your next unit.
+ Added a new BUG option for the stats tab of the info screen: "non-zero stats only".
+ Changed some of the default BUG settings and fixed some minor interface problems. (Note: there was a minor problem in the previous defaults settings which will only be fixed if "Advanced Scoreboard.ini" is deleted from the K-Mod settings folder.)
+ Changed the behaviour of automatic citizen assignment with forced specialists. (Previously, having any forced specialists would forbid the assignment of any non-forced specialists. Now it will allow other specialists when no more of the forced type can be placed.)
+ The diplomacy screen should now allow the human player to declare war even if the AI player refuses to talk. (untested)
+ Alt+click on a leader's name will now open a declare-war popup window rather than just instantly declaring war.
+ Right clicking on a unit in neutral territory will no longer open a declare-war popup. (This makes it more consistent with other right-click behaviour.)

--

v1.05 changelist

+ Fixed a major performance problem in the original BtS code. The AI's turns will now take around half the time they took before. ie. The AI is now 100% faster.
+ Fixed a bug K-Mod in the way the AI sorts their units.

--

v1.04 changelist

+ In the diplomacy screen, pressing "Lets stop this fighting..." will now bring up the trade screen with the AI's suggested peace terms. (Originally, it just made peace instantly without any trades - it was a horrible button.)
+ Added a notification message for when a religion is removed from a city.
+ Adjusted some of the action recommendations for human players. (ie. the blue circles for recommended improvements and city locations.)

+ Adjusted the diplomatic behaviour of AI players who are allied with human players. In particular, the AI will no longer refuse to talk to other humans.
+ Made some more changes ("improvements") to the automatic city citizen allocation system - particularly for the AI.
+ Rewrote the decision making process for the AI's choice of state religion. It should be a bit less rigid now.
+ Restructured and simplified the air unit AI, so that now it will be faster - and probably a bit smarter too. (untested)
+ Fixed and reactivated the attack sections of AI_follow - the main benefit of this is that AI attack stacks will now be able to make better use of the blitz ability of tanks.
+ Corrected the code which was meant to stop AIs from making peace when aiming for conquest victory. (The first attempt was wrong - it basically did nothing.)
+ Gave the AI some basic ability to target poorly defended cities. (I have some ideas to futher improve this in the next version.)
+ Changed some of the trigger conditions and effects of the AI's "big espionage" strategy.
+ Made many minor changes to various AI value weights and decision thresholds and so on.

+ Rewrote the pathCost function used by the pathfinding. This fixes several pathfinding problems & bugs. Most notably, the new code allows the AI to choose a path with involves fighting through enemy units that are in the way; the new code does not take into account movement costs or defensive bonuses for tiles that have not been revealed (this makes the AI cheat less, but it also removes an exploit which allowed human players to determin the positions of islands, roads, etc.).
+ Fixed a potential OOS bug in the K-Mod convert-for-crush code.
+ Fixed a bug in my new volcano event which allowed it to increase the soil fertility of water.
+ (hopefully) Fixed an original BtS bug which did strange things when a unit was ordered to attack a tile which was already mid-battle in simultaneous turn multiplayer. (untested)
+ Fixed a bug in the unofficial patch which causes players to miss out on free techs if they load the autosave from the turn the tech is meant to be awarded. (before this fix, the player got accused of cheating instead of getting their free tech.)
+ Blocked some more python callbacks (for speed).

--

v1.03 changelist

+ Changed the mechanics of the natural spread of religions. With the new system, only the religion with the highest 'grip' gets a chance to spread to a city - but religions may still spread even if the city already has religion. Also, if an existing religion in the city has a lower grip than the new religion, there is a chance that the existing religion will be removed. "grip" is a measure of how strong the religion is in a particular city. It is calculated based on several factors, including proximity to the holy city, the number of religious buildings in the city, the year the religion was founded, and so on. The new system is a fairly significant change, but it isn't one you should have to worry about if you don't want to.
+ Culture flipping is now blocked for the most recent previous owner of a city instead of for all previous owners (when using the default "no flipping after conquest")

+ Fixed some problems in the new automatic citizen assignment code.
+ Changed the way the AI counts food when deciding on plot improvements.
+ Rewrote the AI's strategy for spreading corporations. Hopefully it will spread them a bit smarter now.
+ AIs using the crush strategy will now spend less time preparing for war. (2/3 of the prep normal time)
+ AIs who are fully committed to a conquest victory will no longer make peace for any price unless they don't want a particular war.
+ AIs who are trying to get the last techs for a space victory will no longer use espionage economy.
+ Refined the AIs building value calculations, and production selection calculations.

+ Blocked some more python callbacks.

--

v1.02 changelist

+ Reduced the global warming defence of forests and jungles, from 20 to 15.
+ Reduced the grip effect of religious shrines from 20 to 10. (This affects the probability that a religion will be bumped out of a city when a new missionary comes.)
+ Tech trades in which the receiving player is more than 2/3 of the way through researching the tech or when the tech is behind the 'game era' no longer count towards tech trade memory. ie. They don't contribute to causing "we fear you are becoming too advanced".

+ Adjusted the AI's max unit spending formula so that it is very close to the original BtS formula, but without the BtS problems.
+ The AI will now take obsoletion of buildings into account when evaluating techs.
+ Made some other adjustments to AI tech evaluation.
+ Restructured and adjusted the evaluation code for defensive buildings, and made some other building evaluation adjustments - the main purpose was the reduce of perceived value of city walls by the time Rifling is being considered, so that Rifling isn't blocked by the obsolete penalty for techs.
+ Automated / AI workers will no longer chop tundra forests. More specifically, they won't chop forests unless they are able to replace it with a better improvement.
+ Fixed some problems with the original BtS evaluation of clearing features for improvement building. (It was over-valuing, and double-counting yield changes; but these problems only started to manifest strongly after my feature chopping change.)
+ Fixed an over-counting problem with of workers in the AI, which caused the AI to think it had more workers near a city than it actually had.
+ The AI is now more likely to make escort ships available for their assault groups.
+ Redesigned the trigger conditions and the effects of the "economy focus" AI strategy. (This is a rare strategy in which the AI will choose to neglect its military so that they can focus on boosting their economy.)
+ Tweaked the espionage AI. On large maps, it will now be more likely to use the "espionage economy" strategy.
+ Fixed some original BtS city site placement bugs and problems. In particular, there was a bug which caused the AI to not take planned city sites into account properly. Also, the AI will no longer count the value of tiles that haven't been revealed. (This also affects the blue circle settler recommendations for human players.)
+ Made some other adjustments to city site evaluation. Most noticeably, the AI is now a lot more willing to found cities that are close to one another.
+ Taught the AI how to send unescorted settlers to city locations, and meet an escort mid-way. (Hopefully this doesn't cause the AI to be too reckless with their settlers. Let me know if you see the AI doing something stupid.)

+ Rewrote the code for how the AI and city governor allocate city citizens. The new method is faster, and I think it is also a bit smarter. In particular, it is more likely to work low-food high-value tiles when close to the happiness limit.
+ The city governor will now build spies, missionaries, and execs (but not when you don't need them).

+ Moved (corrected?) the K-Mod multiplayer handicap adjustment. (In multiplayer games of K-Mod, the AI handicap level is set to be the minimum of the human player's level - but I suspect this feature was implemented incorrectly until now.)
+ Combat bonus vs animals and barbarians is now based on player handicap level rather than game handicap level. (This just means that in multiplayer games when players has different difficulty settings they will get different bonuses.)
+ Copied, from Koshling's C2C code, a fix for an original BtS pathfinding bug and pathfinding optimization. This fixes several AI problems.
+ Fixed a possible overflow bug in AI_foundValue and related functions. (thanks to Koshling for the tip)
+ Fixed a possible overflow bug in in AI_techValue.
+ Fixed an original BtS bug which affected when / who would receive feature growth messages. (With this change, you'll probably see more "a forest as grown" messages. The actual growth rate is unchanged, but the message will show up a bit more often.)
+ Fixed a potential double-counting bug in AI_rivalAirPower (triggered by the existence of any unique air units).
+ Fixed a minor problem with super-medic creation in AI_promotionValue (triggered if there is more than one "leader" promotion).
+ Added some new options to PythonCallbackDefines.xml to allow various AI python callbacks to be blocked (for efficiency).

--

v1.01 changelist

+ "Lost production" for units is now assigned to another unit of the same type (previously, it was converted into gold). With this change, it is possible to build more than one unit per turn. (Note: this does not affect normal production overflow. It only affects the production beyond the overflow limit.)
+ Made some minor changes to the auto-build city governor. (I think auto-build works pretty well now.)
+ Espionage AI value is now reduced if the player has spent less than a quarter of their total points (this means that if you aren't spending your espionage points, the city governor should stop automatically assigning spy specialists.)
+ Rewrote the decision code for bombarding / skipping bombard for city attack.
+ Rewrote parts of the raze city decision code - the AI will now be less likely to keep useless ice cities, and more likely to keep conquered land on other continents.
+ Fixed a couple of minor BtS bugs in worker recommendations.
+ Made a lot of backend changes which will speed up some parts of the game, but also make the game more resistant to OOS bugs.

--

v1.00 changelist

NOTE: This patch changes the save file format. K-Mod saves from previous versions will not work with this version.

+ Added a new religion mechanic: existing religions may be removed from cities when a new religion is spread to them with a missionary. The following factors reduce the likelihood that a religion will be removed: number of religious buildings in the city, proximity to the holy city, the existence of the holy building (wherever it is), the turn the religion was founded (religions founded later will be less likely to be removed), the population of the city (larger cities are less likely to have religions removed). Note: the effects of this new religion system are actually very minor in the current version. It's a somewhat experimental feature.
+ Adjusted the missionary spread probability. Bigger cities are now less likely to have religions fail to spread (and less likely to lose religions).
+ Added some loading tips (hints) for K-Mod specific features. (Currently these are in English only.)
+ Tweaked global warming plot targeting.

+ Made some changes to espionage & spy usage; mostly to scale better with different game speeds and map sizes, but also to make better use of spies when espionage rate is low.
+ The AI will now send spies to destroy improvement only when at war.
+ The AI will no longer agree to requests for gifts from civs which it is planning war with.
+ Made some changes to the AI's macro-economics decision making... unit supply limit, empire splitting, financial trouble.
+ Changed the way "unit cost percentage" is calculated. The original calculation wrongly assumes that high unit cost, or low maintenance cost, imply large military - this is bad on many levels. This change is actually quite far reaching; and more work needs to be done to correct some of the flow-on effects.
+ Made several adjustments / fixes to the AI's building evaluation function.
+ Restructured and adjusted the value of yield all through the AI.
+ Changed default AI mode for axemen and macemen, from both "counter" to "attack" and "attack_city" respectively.
+ Tweaked some of the great person AI.
+ Further increased the AI's value of space techs when aiming for space victory.
+ Fixed an original BtS bug which, under most conditions, prevented settlers from moving towards the same target site two turns in a row. (It's a wonder how they managed to get anywhere useful at all!)
+ Adjusted the rules the AI uses for deciding when not to build workers - the original rules would often block them from choosing a worker in their starting city.
+ Changed to city site evaluation formula so that it rates cities as zero if they are too close to existing planned city sites.
+ Fixed a K-Mod bug which was preventing the AI from using great merchant trade missions.
+ Fixed a K-Mod bug which caused the AI to never actually carry out their intended sabotage plot improvement espionage missions.

+ Added a new unit AI type: UNITAI_GREAT_SPY. (Previously, great spies shared their AI with great merchants.)
+ Added four new AI mission types (these are just names that are useful when writing AI code).
+ Reduced the use of mutable variables in the cache system. Restructured when and where cache is refreshed. (This should have no effect on gameplay, but I think it will make it harder to create OOS bugs.)

v1.00b
+ Fixed a bug which prevented religions from being removed as intended.
+ Added a missing factor of 100 in gold value for AI_cityValue.
+ Adjusted the AI's decision making regarding unit spending to bring the probability of war back down closer to standard BtS levels.

--

v0.99 changelist

+ Rewrote the decision making process for switching civics.
+ Changed the golden age evaluation function to take into account golden age length modifiers, and possible civic changes. Also, I've greatly increased the perceived value of golden age yield. It should be more accurate now.
+ The AI can now save its great people for for multi-great-person golden age.
+ The AI will now always check its civics on the last turn of a golden age.
+ Hardened the requirements for the AI giving free tech to human vassals.
+ Changed the way the AI decides whether or not to cancel a deal - previously the AI would always cancel deal with other AIs after 20 turns, I suspect this was an original BtS bug. Also, the AI previously would cancel gift deals to vassals and then immediately re-offer them. It doesn't do that anymore.
+ Changed the conditions the AI uses for deciding whether or not to aim for a cultural victory.
+ Cities which the AI refuses to trade will no longer appear on the AI's trade table.

+ Rewrote most of the AI's city production decision making. It's far less rigid now - there may be some kinks to work out in the new system.
+ Completely replaced the city governor (auto production). Hopefully, the governor will be more useful now. It's similar to the new AI code.
+ Rewrote the way building happiness and healthiness are evaluated.
+ The AI will now avoid building limited buildings in cities which value the building at less than 80% of the other possible cities. (This applies to national wonders and cathedrals.)

+ Greatly reduced the probability of "spontaneous" espionage missions.
+ Completely changed the way the AI decides whether a spy should be used for offence or defence.
+ The AI will no longer send spies on attack missions when it hardly has any points to spend.
+ Changed the conditions that trigger the Big Espionage strategy.
+ The AI now sees "spread culture" espionage missions as "non-malicious". i.e. The AI now thinks its ok to spread culture to its friends. I've rewritten the evaluation of these missions so that it will try to use them defensively when it is being culture crushed.
+ AI espionage weights are now calculated and set even if the AI is researching an undiscovered tech (this use to be an original bts "feature").

+ Added an estimation of collateral damage strength to the AI's plot strength functions.
+ AI city attack ratio now has some dependence on the AI's individual strategy.
+ Changed the conditions for when the AI will build collateral units. (There will be slightly more offensive collateral, less defensive collateral.)
+ Rewrote the BBAI war success ratio code to scale properly for wars of different sizes in different eras - this will help the AI better understand whether it should be attacking or defending.

+ Fixed an original BtS bug which caused AI_getEspionageTargetValue to ignore its "iMaxPath" argument.
+ Fixed a minor original BtS bug which in the evaluation of maintenance reduction buildings.
+ Fixed a minor original BtS bug in the application of the force-peace resolution when the peace-team has vassalated.
+ Fixed an problem in the original BtS code for deciding whether an AI has "financial trouble". Previously, if the AI decided to use lots of culture or espionage, that would cause it to mistakenly think it was in financial trouble.
+ Fixed a problem which caused AI spies to forget what their mission was after they enter enemy territory. (For example, a spy might set off to some distant city, and then half way their decide that it should be retreating to base because it doesn't know what to do.) - (not sure if this was BBAI or original BtS)
+ Fixed an original BtS bug which caused the AI to continuously build "early sea explorers" in the late game.
+ Fixed an original BtS bug which caused AI civs to be more much likely to split their empire when they run high culture or high espionage.
+ Fixed an original BtS bug which caused AI spies to not know when they couldn't perform an espionage mission. (in fact, the AI use to cheat - it could perform espionage on the same turn the spy moved. It can't do that anymore.)
+ The AI's spies now use the mission queue for espionage missions; previously they just performed the mission immediately. (Could this fix an OOS race-condition?)
+ Fixed an original BtS bug which allowed spies to perform the force-religion mission on Civs with Free Religion.
+ Fixed an original BtS bug which prevented the civic-switch message from being sent when a civilization switched back to one of their starting civics.
Fixed an original BtS bug which prevented improvement builds which remove a bonus from being penalised. (I claimed to have fixed this bug before. I was wrong.)
+ Fixed an original BtS bug which sometimes caused civs aiming for cultural victory to waste their cathedrals.

+ Fixed a problem in the BBAI code which caused the AI to think faster bombard was bad rather than good.
+ Fixed a BBAI bug which double-counted city defence when deciding whether to attack a city.
+ Fixed a BBAI problem which sometimes caused attack stacks to get stuck indefinitely, unable to choose between attacking and pillaging.

+ Fixed some bugs in the attitude cache from the CAR mod.

+ Fixed a K-Mod bug which caused bulbing to be massively undervalued.
+ Fixed a K-Mod bug which completely disabled GW anger!

--

v0.98 changelist

+ Added the Advanced Combat Odds mod. [You can activate it from the BUG options menu.]
+ Changed the way stolen gold is calculated for espionage missions. [Previously, the amount of gold stolen was inversely proportional to the target civs number of cities!]
+ Changed the way switch civic / religion costs are calculated for espionage missions. [The cost now scales with the size of the civ.]
+ Added 4 culture to the Kremlin.

+ Tweaked the AI's conscription decision making.
+ Fixed a BBAI bug which was preventing the AI from ever using their "crush" strategy!
+ Made many adjustments to the (now enabled) crush strategy.
+ Adjusted the build probabilities of different unit types.
+ Added new attack conditions for collateral unit AI. [to try to fix the problem of the AI stockpiling collateral units for 'defence', but never using them.]

+ The AI will now try to recognise when its units are out of date, and thus aim for tech which will help them.
+ Changed tech unit value to be reduced if other prereqs are missing. [So that, for example, the unit value of assembly line is not higher then rifling if you don't have rifling!]
+ Unit value is awarded for secondary tech prereqs if the player already has the primary prereq.

+ Fixed an original BtS bug which would sometimes prevent AI spies from doing any espionage missions.
+ Fixed an original BtS bug which prevent the AI from using the culture slider for anything other than a cultural victory.
+ Rewrote the AI's decision making process for choosing the best espionage mission. [You're probably use to the AI just using Poison Water Supply over and over; so brace yourself for some more painful missions.]
+ Reworked most of the spy unit AI code; choosing target cities etc.
+ Changed many parts of the AI's espionage strategies. (points targeting etc.)
+ Implemented a new AI strategy: espionage economy. The way it works is that when the AI recognises that stealing techs is significantly cheaper than researching them - it may choose to focus on espionage instead of research. [The conditions for this strategy are pretty strict. Don't be surprised if you never see the AI try it.]
+ Increased the build priority of spies, so that the AI will still sometimes build them when at war.
+ The AI's espionage targets are now adjusted for different game speeds.

+ Rewrote most of the decision making process for "Force Peace" votes, to take into account relative power. [Previously, if an AI player had lost a few more units in the war, then it would vote for peace even if it was much stronger and even if aiming for a conquest victory!]
+ Replaced most of the AI's great person usage decisions with a new decision making process. [Before this change, the AI would _always_ use its great spies to build Scotland yard, unless every city already had it. The logic process was quite absurd.]
+ Added some personality-based changes to city site evaluation.
+ Fixed some problems in the way the AIs main strategies are chosen, to decorrelate "random" decisions.
+ Corrected a bug in the calculation of average commerce yield modifier.
+ Changed the way happiness and healthiness are evaluated for civics.
+ Tweaked the usage of, and civic value of, conscription.
+ Changed the way the AI classifies war areas - to correct a problem which sometimes caused the AI to use an "offense" strategy when it was losing an intercontinental battle.

+ Changed many parts of how the AI chooses which improvements to build. [I'll list some...]
+ Changed the AI's definition of a "good tile", and hence changed their city population targets.
+ Changed the way the AI counts and evaluates a city's total food.
+ Changed the scaling of the AI's commerce weight for improvement evaluation.
+ Fixed an original BtS bug which prevented improvement builds which remove bonus from being penalised.
+ When choosing an improvement, the AI will now try to anticipate how the improvement will change their future needs - this should reduce the AI's tendency to oscillating between different improvements.
+ Automated (human) workers will now try to avoid working near enemy borders when at war.

+ Fixed an bug in the original BtS ironclad animation file.
+ Removed / fixed some false debug assertions and logging problems; from my code, BBAI code, and from BtS code. [This only applies to the Debug build]

--

v0.97 changelist

NOTE: This patch changes the save file format. K-Mod saves from previous versions will not work with this version.

+ Increased cost of The Great Lighthouse, from 200 to 300.
+ Increased Environmentalism upkeep from medium to high.
+ Made some minor changes to some corporation stats.
+ Global warming events are now slightly more biased towards cold tiles.
+ Decreased event message stagger time.
+ GwPercentAnger, average culture press, and building value are now all cached. [no effect on gameplay, but it may make the game run slightly faster.]
+ Changed the way Lead From Behind works. [Previous, LFB was so overly-protective of high-value units that it would not allow warlord-defenders to actually defend.]

AI changes:
+ Adjusted the AI's criteria for drafting.
+ Adjusted spy building decision making.
+ Adjusted espionage mission evaluation.
+ Added new strategies for espionage points targeting.
+ Tweaked city site evaluation.
+ Fixed some problems in the AI's culture pressure response.
+ In most cases, the AI will no longer choose low productivity cities to build floating defenders.
+ The AI now correctly estimates no pollution change from population-pollution reduction in cities that are already at 100% reduction.
+ The AI will no longer try to 'save up' culture wonders unless it is aiming for a cultural victory.
+ For health and happiness in civic evaluation, the AI now distinguishes between switching into a bonus and out of a bonus.
+ Commerce multipliers from civics are now valued in a more reasonable way.
+ The AI will no longer try to save the Moai Statues for a city that already has high productivity.
+ Added some new strategies to help the AI catch-up if it falls behind in tech.
+ Tweaked the conditions and effects of the AI's "crush" strategy.
+ Rewrote the AI's city evaluation of specialists.
+ Rewrote parts of the AI's evaluation of corporation HQ, effect on cities, and civics. [It will now choose its HQ cities more wisely.]

v0.97b
+ Fixed a bug which was completely preventing global warming.

--

v0.96 changelist

+ (This patch only has AI changes. There are no balance changes or new features.)
+ Improved the way the AI detects when it is being culture pressed
+ Taught the AI to understand the value of prerequisite buildings such as temples and universities.
+ Fixed a BtS AI bug related to cathedral building value.
+ Taught the AI to understand removable features (such as jungles) and the value of rivers when choosing city sites. (as well as few other city site evaluation tweaks)
+ The AI will now be a bit less enthusiastic about settling in useless places in the late-game.
+ Made a few minor changes to the AI tech evaluation function.
+ Made some further changes to the AI civic evaluation function.

--

v0.95 changelist

+ Many AI improvements, including better evaluation of civics, more awareness of cultural pressure, proper understanding of how environmentalism will affect GW anger, better understanding of the difference between techs that 'reveal' a resource and techs that 'enable' a resource, tweaks for espionage mission choices and nuke building, and more.
+ Fixed a bug from the original BtS code, which sometimes caused the AI to include their own military power when counting the power of a potential military target.
+ Representation science bonus reduced from +3 to +2 (!!)
+ Representation upkeep reverted to 'medium'. [its a big nerf, and yet rep. is still very powerful.]
+ Rebalanced the build up of GW anger. Compared to the old version, GW anger will now build up slower but reach a slightly higher level in games that are severely affected by global warming.
+ Adjusted the affect of "relative contribution" on GW anger. The new version is slightly more sensitive to changes close to 100%, and less harsh on civs that have more than 150%.
+ The immediate experience boost from Great Generals (when used as a 'warlord') is now increased by 10% for each affected unit, up to a maximum of +100% (ie. 40 xp shared across 11 units).
+ Increased the food production by cereal mills corp, from 0.75 food per resource up to 1 food per resource. [Maybe now it will be able to challenge sushi co?]
+ Changed the sound effect for GW events, and for the signing of defensive pacts & permanent alliances.
+ A couple of minor UI changes.

--

v0.94 changelist

 + Tweaked some of the AI's tech evaluation formulas, and fixed a bug in the tile improvement evaluation. The changes are only minor, but I think the AI will be noticeably stronger now.
 + Changed the game initialization to set the game handicap level to be the minimum of the human players' handicap levels. This is so that the AI does not default to "noble" in multiplayer games.
 + Free technology bonuses from goody huts are now allowed without settling a city first.
 + Decreased production cost of cathedrals (etc) from 300 to 240.
 + Drafted units are now included in the stats screen's units-built tally.
 + Global warming can no longer turn desert (or anything else) into coast. [I don't think this feature made the game more fun, and there were a few minor problems with it, such as graphical glitches.]
 + The volcano event now has a chance of increasing the food yield of adjacent tiles (in addition to the original effects); as part of this change, I also fixed the Python API so that calculateNatureYield() actually works. I see that the same bug exists in several other python functions, but I'll only fix it when I need the functions; also, getPlotExtraYield() is now available in python.
 + Cottages and hamlets destroyed by the volcano event will no longer leave city ruins.
 + Lowered the threshold for global warming severity to be described as "high" (this change has no effect on gameplay).

--

v0.93 changelist

 + Changed Odeon culture from 3 to 2.
 + Changed Arabian Madrassa culture from 4 to 3
 + Changed culture from Great Works to be base_rate * era, rather than base_rate * (era+1)
 + Reverted State Property upkeep back to 'low' [Now that state property no longer eliminates colony maintenance, and corporations come into the game earlier, I feel that state property is not too powerful on low upkeep.]
 + Increased Representation upkeep from 'medium' to 'high'
 + Increased cost of public transport to 200 (from 150)
 + Global warming can no longer strike impassable peak tiles
 + Fixed a bug which caused terrain to be degraded at the same as trees were degraded. [The correct behaviour is jungle->forest->nothing before any terrain degradation takes place.]
 + Fixed problem which sometimes caused towns not to be removed when global warming made the land uninhabitable. [I'm in two minds about whether desert towns should be allowed to stay; but for now I'm disabling it.]
 + Minor adjustments to the environmental advisor screen.
 + Mining inc now uses aluminium and uranium instead of gold and silver [this should make mining inc slightly weaker, and civ jewellers more viable]

--

v0.92 changelist

 + Fixed a bug that would cause K-Mod to crash when playing with time victory disabled. (added a new xml parameter for controlling global warming chances per index)
 + Removed all the custom map scripts that previously came with the mod. (These scripts aren't part of the mod. They can be installed separately by those who want them.)
 + Fixed a bug that was preventing promotions with three 'or' prerequisites from being displayed.
 + Added third promotion 'or' prerequisite information to the civilopedia (and sevopedia)
 + Changed the tech chooser bulb preference list to only show techs that have not already been researched
 + Disabled some faulty event handlers in Civ4lerts. [They didn't work, and they looked like they might cause a seg-fault.]
 + Changed the global warming responsibility calculation to include offsets.

--

v0.91 changelist

 + fixed a K-Mod bug that caused some cultural revolts to last much longer than they should.
 + changed the length of cultural revolts 3 + 2*(number of previous revolts), so that the system is simpler. [previously it depended on the current era, the highest population of the city, and the number of adjacent plots owned by the player]


---

K-Mod, version 0.9 (beta)

A list of differences between K-Mod v0.9 and standard Civ4:BtS. There may be things missing.


== Built-in mods ==
 + Actual quotes
 + Better AI (customised)
 + BUG (butchered)
 + unofficial patch

== Civics ==
 + serfdom: +1 commerce farms & plantations, -1 commerce from towns [I want to make serfdom a useful mid-game civic]
 + Vassalage: -25% number of cities maintenance
 + State property: high upkeep (up from low)
 + free speech: from +100% culture to +50%. [now that culture is more powerful, this needed a nerf.]
 + Environmentalism: removed health bonuses, replaced with -30% unhealthiness from population, removed the corp maintenance penalty.

== Traits ==
 + protective: +100% build rate for security bureau
 + aggressive: +100% build rate for jails (and mausoleum)

== Culture ==
 + trade route culture: trade routes give plot culture in addition to commerce. The amount of culture given by the trade route is 1% * trade city's culture level * trade city's culture rate. The culture belongs to the owner of the trade city, not the local city; and it is not counted towards the culture of the city itself  it only effects the plots around the city.
 + changed plot culture mechanics: cultural influence extends 3 steps beyond the border. Outer ring of cultural influence gets 100% of the city culture; the city tile itself gets 1000%; the rate varies quadratically in between.
 + instant boosts to culture (such as great works and espionage missions) now apply the appropriate amount of plot culture with their city culture
 + change culture from great works from a flat 4000 to 800 * era. [to reduce the power of the early culture bombs  but it's worth pointing out that early culture bombs are still very powerful]
 + Reduced culture of many buildings: 
 + reduced the culture from most of the great wonders
 + Sistine chapel state religion culture bonus changed from +5 to +3 [culture is more powerful now; so this building needed to be nerfed]
 + sushi co. now produces 1.5 culture per resource, down from 2 culture per resource. [still the most powerful corp...]
 + colosseum cost 80 -> 100, now gives 20% culture rate bonus. [I wanted a early culture multiplier that would apply to all cities.]
 + religious building culture multiplier down from 50% to 40% [to de-emphisize the role religion plays in culture; and the balance the colosseum buff]


== Misc balance changes ==
 + industrial park cost from 200 to 250, 1 free engineer to 2 free engineers. [pollution hurts more now, so this building needed a buff]
 + jail, from +4 espionage -> +2. [+4 and +50% was too powerful for a relatively early game building which has other benefits]
 + Eiffle tower now comes with mass media instead of radio [to make mass media more appealing, and make free broadcasting towers less weird]
 + ironclad, from 2 moves to 3. [the ironclad was frustratingly slow... with this buff it is still slower than galleons]
 + public transport, removed health bonuses, replaced with -15% unhealthiness from population, [thinking of raising cost from 150->200.]
 + stone henge no longer goes obsolete [I felt that this wonder was actually disadvantageous, because the 'free' monuments disappeared and thus robbed the owner of late-game culture]
 + tech requirements for corporations changed: civ jewellers: corporation, sushi co: refrigeration, cereal mills: medicine, creative constructions: steel, standard ethanol: combustion [in my experience, sushi and mining inc are always by far the most powerful corporations. My goal with changing the prereqs is to make the weaker corps more viable.]
 + space elevator bonus from +50 spaceship production -> +100%. [building this wonder is almost never worth the hammers/research... I suspect that even with this massive buff it will still be too weak to be worthwhile.]
 + free commando promotion for great spy [just like a normal spy]
 + slightly reduced the tech rate for everything in the later eras (slowed research), using the BBAI defaults
 + work boats no long count as military units
 + all promotions that have a combat promotion as an optional prereq also now have the equivalent drill promotion as an optional prereq. 

(march, blitz, etc)
 + leadership promotion now gives 50% protection vs revolt (in addition to +100% experience gained)


== Minor mechanics changes ==
 + Nuclear meltdowns: no longer destroy other buildings or population. Can still create fallout. [meltdowns were far too powerful]
 + The count of vassal cities is now halved in the number of cities maintenance calculation. [To make vassalizing more attractive]
 + "Number of cities" maintenance cost is no longer capped (ignores the caps set in the xml) [to weaken the power of huge civs]
 + Distance maintenance modifiers no longer effect the cap on colony maintenance. [So that 'State Property' does not remove colony maintenance.]
 + removed attitude averaging between vassals and masters [I felt the previous behaviour was unintuitive, undocumented, and discouraged vassalizing]
 + made it possible to pillage ones own roads [for consistency; and because it's sometimes useful. eg. when you are trying to grow a forest]
 + preventing a cultural revolt with a military garrison is now more difficult (asymptotically more difficult)
 + changed the scaling of revolt chance with military garrison (from linear, to something else... small garrisons are relatively more effective than they were before).
 + removed the free liberation culture for cities that have already been owned [to prevent an exploit]


== Misc ==
 + fixed some bugs in the standard game and in the BUG mod.
 + made some adjustments to the AI; now will build more workers, tech less predictably, be less afraid of buildings that cause unhealthiness, etc.
 + reduced rounding errors in plot culture.
 + added an 'environmental advisor' as a tab on the financial advisor screen; it displays most of the relevant information related to pollution and global warming.
 + added religion bonus information to the mouse-over text in the city-screen for buildings being constructed. (eg. university of sankore bonus on temples)
 + removed the double-reporting of conditional happiness and healthiness from mouse-over text on buildings. (eg. happiness from theatre with culture slider, happiness from barracks with nationhood, etc. These bonuses are now displayed once, not twice.)
 + changed text for bonuses from an arbitrary state-religion (eg university of sankore) to always say 'state religion' rather than a particular region.
 + added global warming unhappiness; depends on global warming index, current global pollution rate, current local pollution rate, land size. added mouse over text in city screen, and so on.
 + global warming can turn coastal desert tiles into ocean. When this happens, units will be bumped to a nearby tile
 + removed the extra space in "unit can " list for unit descriptions (eg. work boats)

== New culture system ==
Perceived problems with the old system:
In the old system, plot culture was essentially dominated by 'free culture' from cities. The actual culture output of a city had very little effect other than to increase the culture level of the city. In a culture war (where two civs attempt to push each other's borders back with culture) the culture slider wasn't much use, because the culture output of a city had a relatively minor role on plot culture. 

Two cities would almost always be able to culture press a solo city even when the solo city had much more culture output than the combined total of the two cities. "Culture bombs" did almost nothing, and using spies to spread culture had essentially the same effect on plot culture as a great artist culture bomb! And culture was only useful in border cities (and in the top three culture cities when trying to get a cultural victory).

My solutions:
Plot culture is now primarily determined by the culture output of cities. The 'free' culture has been reduced to almost nothing. (I haven't completely removed free culture because otherwise it would be too easy for civs with the cultural trait to culture press in the early game.) Instant boosts to culture, such as great works and espionage missions, now apply as much plot culture as if the city had produced the culture in the normal way. Finally, plot culture from a city now extends a couple of squares beyond the borders of the city, and so cities don't need to be right on the border of the civilization to contribute to a culture war.

== New global warming system ==
In standard BtS, global warming is a bit of a joke. It is triggered by the wrong things, you can't really do much to prevent it, and it hits the world in a harsh and unintuitive way. I've completely changed it.

In short, it works like this:
Every point of unhealthiness is counted across the world. If this total is more than some threshold amount then global warming becomes possible, and the likelihood increases as long as the unhealthiness total is above the threshold. There is an environmental advisor which can tell you all the details (on the same screen as the financial advisor).

When global warming strikes, it no longer removes the tile improvement, and it doesn't turn the tile straight into desert, so each strike is far less severe than in original BtS. Also, global warming is more likely to strike cold tiles before hot tiles. eg. The ice caps are likely to melt before your plains get turned into desert.

Positive healthiness (eg. from hospitals) does not reduce the global warming pollution, but a environmentalism and public transport have been changed so that they do reduce unhealthiness rather than increase healthiness.

As global warming becomes more likely, civilizations start to get a happiness penalty which is based on their relative contribution to global pollution.